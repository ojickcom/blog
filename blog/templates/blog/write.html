{% extends 'base.html' %}

{% block title %}블로그 작성{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10">
        <h1 class="mb-4">✏️ 새 블로그 작성</h1>
        
        <form method="post" id="blogForm">
            {% csrf_token %}
            
            <!-- 제목 미리보기 -->
            <div class="title-preview" id="titlePreview">
                <strong>📌 제목 미리보기:</strong>
                <div id="previewText" class="mt-2 text-primary">
                    제목 구성 요소를 입력하면 미리보기가 표시됩니다
                </div>
            </div>
            
            <div class="row">
                <!-- 기본 정보 -->
                <div class="col-md-6">
                    <h5 class="mb-3">📋 기본 정보</h5>
                    
                    <div class="mb-3">
                        {{ form.content.label_tag }}
                        {{ form.content }}
                        {% if form.content.errors %}
                            <div class="text-danger">{{ form.content.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-3">
                        {{ form.client_type.label_tag }}
                        {{ form.client_type }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form.image_url.label_tag }}
                        {{ form.image_url }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form.place_name.label_tag }}
                        {{ form.place_name }}
                    </div>
                </div>
                
                <!-- 제목 구성 요소 -->
                <div class="col-md-6">
                    <h5 class="mb-3">🏷️ 제목 구성 요소</h5>
                    
                    <div class="mb-3">
                        {{ form.content_title.label_tag }}
                        {{ form.content_title }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form.content_number_character.label_tag }}
                        {{ form.content_number_character }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form.content_talkstyle.label_tag }}
                        {{ form.content_talkstyle }}
                    </div>
                    
                    <div class="mb-3">
                        {{ form.content_aspect.label_tag }}
                        {{ form.content_aspect }}
                    </div>
                </div>
            </div>
            
            <div class="d-flex justify-content-between mt-4">
                <a href="{% url 'blog_list' %}" class="btn btn-secondary">
                    ⬅️ 목록으로
                </a>
                <button type="submit" class="btn btn-primary">
                    💾 작성 완료
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// 제목 미리보기 기능
function updateTitlePreview() {
    const contentTitle = document.querySelector('input[name="content_title"]').value || '';
    const contentNumberCharacter = document.querySelector('input[name="content_number_character"]').value || '';
    const contentTalkstyle = document.querySelector('input[name="content_talkstyle"]').value || '';
    const contentAspect = document.querySelector('input[name="content_aspect"]').value || '';
    
    const titleParts = [contentTitle, contentNumberCharacter, contentTalkstyle, contentAspect]
        .filter(part => part.trim() !== '');
    
    const previewText = titleParts.length > 0 
        ? titleParts.join(' ') 
        : '제목 구성 요소를 입력하면 미리보기가 표시됩니다';
    
    document.getElementById('previewText').textContent = previewText;
}

// 입력 필드에 이벤트 리스너 추가
document.addEventListener('DOMContentLoaded', function() {
    const titleInputs = [
        'input[name="content_title"]',
        'input[name="content_number_character"]',
        'input[name="content_talkstyle"]',
        'input[name="content_aspect"]'
    ];
    
    titleInputs.forEach(selector => {
        const input = document.querySelector(selector);
        if (input) {
            input.addEventListener('input', updateTitlePreview);
        }
    });
});
</script>
{% endblock %}
